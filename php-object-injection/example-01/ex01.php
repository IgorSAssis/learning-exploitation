<?php
// Run this code to see exploit happening
// php ex01.php 'O:4:"test":1:{s:3:"dir";s:1:".";}'

class test {

  public $dir = ".";

  public function __wakeup() {
      echo "Printing files in this folder...\n";
      system("ls " . $this->dir);
  }
}

$obj = new test();
$serialized_obj = serialize($obj);
echo "Example of an serialized object: $serialized_obj\n";

echo "Arg 01: " . $argv[1] . "\n";
echo "Unserializing arg1...\n";
unserialize($argv[1]);
